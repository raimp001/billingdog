{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SCWStateManager = void 0;\nconst ScopedLocalStorage_1 = require(\"../../util/ScopedLocalStorage\");\nconst ACCOUNTS_KEY = 'accounts';\nconst ACTIVE_CHAIN_STORAGE_KEY = 'activeChain';\nconst AVAILABLE_CHAINS_STORAGE_KEY = 'availableChains';\nconst WALLET_CAPABILITIES_STORAGE_KEY = 'walletCapabilities';\nclass SCWStateManager {\n  get accounts() {\n    return this._accounts;\n  }\n  get activeChain() {\n    return this._activeChain;\n  }\n  get walletCapabilities() {\n    return this._walletCapabilities;\n  }\n  constructor(params) {\n    var _a, _b;\n    this.storage = new ScopedLocalStorage_1.ScopedLocalStorage('CBWSDK', 'SCWStateManager');\n    this.updateListener = params.updateListener;\n    this.availableChains = this.loadItemFromStorage(AVAILABLE_CHAINS_STORAGE_KEY);\n    this._walletCapabilities = this.loadItemFromStorage(WALLET_CAPABILITIES_STORAGE_KEY);\n    const accounts = this.loadItemFromStorage(ACCOUNTS_KEY);\n    const chain = this.loadItemFromStorage(ACTIVE_CHAIN_STORAGE_KEY);\n    if (accounts) {\n      this.updateListener.onAccountsUpdate({\n        accounts,\n        source: 'storage'\n      });\n    }\n    if (chain) {\n      this.updateListener.onChainUpdate({\n        chain,\n        source: 'storage'\n      });\n    }\n    this._accounts = accounts || [];\n    this._activeChain = chain || {\n      id: (_b = (_a = params.appChainIds) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : 1\n    };\n  }\n  updateAccounts(accounts) {\n    this._accounts = accounts;\n    this.storeItemToStorage(ACCOUNTS_KEY, accounts);\n    this.updateListener.onAccountsUpdate({\n      accounts,\n      source: 'wallet'\n    });\n  }\n  switchChain(chainId) {\n    var _a;\n    const chain = (_a = this.availableChains) === null || _a === void 0 ? void 0 : _a.find(chain => chain.id === chainId);\n    if (!chain) return false;\n    if (chain === this._activeChain) return true;\n    this._activeChain = chain;\n    this.storeItemToStorage(ACTIVE_CHAIN_STORAGE_KEY, chain);\n    this.updateListener.onChainUpdate({\n      chain,\n      source: 'wallet'\n    });\n    return true;\n  }\n  updateAvailableChains(rawChains) {\n    if (!rawChains || Object.keys(rawChains).length === 0) return;\n    const chains = Object.entries(rawChains).map(([id, rpcUrl]) => ({\n      id: Number(id),\n      rpcUrl\n    }));\n    this.availableChains = chains;\n    this.storeItemToStorage(AVAILABLE_CHAINS_STORAGE_KEY, chains);\n    this.switchChain(this._activeChain.id);\n  }\n  updateWalletCapabilities(capabilities) {\n    this._walletCapabilities = capabilities;\n    this.storeItemToStorage(WALLET_CAPABILITIES_STORAGE_KEY, capabilities);\n  }\n  storeItemToStorage(key, item) {\n    this.storage.setItem(key, JSON.stringify(item));\n  }\n  loadItemFromStorage(key) {\n    const item = this.storage.getItem(key);\n    return item ? JSON.parse(item) : undefined;\n  }\n  clear() {\n    this.storage.clear();\n  }\n}\nexports.SCWStateManager = SCWStateManager;","map":{"version":3,"names":["Object","defineProperty","exports","value","SCWStateManager","ScopedLocalStorage_1","require","ACCOUNTS_KEY","ACTIVE_CHAIN_STORAGE_KEY","AVAILABLE_CHAINS_STORAGE_KEY","WALLET_CAPABILITIES_STORAGE_KEY","accounts","_accounts","activeChain","_activeChain","walletCapabilities","_walletCapabilities","constructor","params","_a","_b","storage","ScopedLocalStorage","updateListener","availableChains","loadItemFromStorage","chain","onAccountsUpdate","source","onChainUpdate","id","appChainIds","updateAccounts","storeItemToStorage","switchChain","chainId","find","updateAvailableChains","rawChains","keys","length","chains","entries","map","rpcUrl","Number","updateWalletCapabilities","capabilities","key","item","setItem","JSON","stringify","getItem","parse","undefined","clear"],"sources":["/Users/shardingdog/billingdog/node_modules/@coinbase/wallet-sdk/dist/sign/scw/SCWStateManager.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SCWStateManager = void 0;\nconst ScopedLocalStorage_1 = require(\"../../util/ScopedLocalStorage\");\nconst ACCOUNTS_KEY = 'accounts';\nconst ACTIVE_CHAIN_STORAGE_KEY = 'activeChain';\nconst AVAILABLE_CHAINS_STORAGE_KEY = 'availableChains';\nconst WALLET_CAPABILITIES_STORAGE_KEY = 'walletCapabilities';\nclass SCWStateManager {\n    get accounts() {\n        return this._accounts;\n    }\n    get activeChain() {\n        return this._activeChain;\n    }\n    get walletCapabilities() {\n        return this._walletCapabilities;\n    }\n    constructor(params) {\n        var _a, _b;\n        this.storage = new ScopedLocalStorage_1.ScopedLocalStorage('CBWSDK', 'SCWStateManager');\n        this.updateListener = params.updateListener;\n        this.availableChains = this.loadItemFromStorage(AVAILABLE_CHAINS_STORAGE_KEY);\n        this._walletCapabilities = this.loadItemFromStorage(WALLET_CAPABILITIES_STORAGE_KEY);\n        const accounts = this.loadItemFromStorage(ACCOUNTS_KEY);\n        const chain = this.loadItemFromStorage(ACTIVE_CHAIN_STORAGE_KEY);\n        if (accounts) {\n            this.updateListener.onAccountsUpdate({\n                accounts,\n                source: 'storage',\n            });\n        }\n        if (chain) {\n            this.updateListener.onChainUpdate({\n                chain,\n                source: 'storage',\n            });\n        }\n        this._accounts = accounts || [];\n        this._activeChain = chain || { id: (_b = (_a = params.appChainIds) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : 1 };\n    }\n    updateAccounts(accounts) {\n        this._accounts = accounts;\n        this.storeItemToStorage(ACCOUNTS_KEY, accounts);\n        this.updateListener.onAccountsUpdate({\n            accounts,\n            source: 'wallet',\n        });\n    }\n    switchChain(chainId) {\n        var _a;\n        const chain = (_a = this.availableChains) === null || _a === void 0 ? void 0 : _a.find((chain) => chain.id === chainId);\n        if (!chain)\n            return false;\n        if (chain === this._activeChain)\n            return true;\n        this._activeChain = chain;\n        this.storeItemToStorage(ACTIVE_CHAIN_STORAGE_KEY, chain);\n        this.updateListener.onChainUpdate({\n            chain,\n            source: 'wallet',\n        });\n        return true;\n    }\n    updateAvailableChains(rawChains) {\n        if (!rawChains || Object.keys(rawChains).length === 0)\n            return;\n        const chains = Object.entries(rawChains).map(([id, rpcUrl]) => ({ id: Number(id), rpcUrl }));\n        this.availableChains = chains;\n        this.storeItemToStorage(AVAILABLE_CHAINS_STORAGE_KEY, chains);\n        this.switchChain(this._activeChain.id);\n    }\n    updateWalletCapabilities(capabilities) {\n        this._walletCapabilities = capabilities;\n        this.storeItemToStorage(WALLET_CAPABILITIES_STORAGE_KEY, capabilities);\n    }\n    storeItemToStorage(key, item) {\n        this.storage.setItem(key, JSON.stringify(item));\n    }\n    loadItemFromStorage(key) {\n        const item = this.storage.getItem(key);\n        return item ? JSON.parse(item) : undefined;\n    }\n    clear() {\n        this.storage.clear();\n    }\n}\nexports.SCWStateManager = SCWStateManager;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}